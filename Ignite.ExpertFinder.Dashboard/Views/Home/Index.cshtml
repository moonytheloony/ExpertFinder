@using Ignite.ExpertFinder.Dashboard.Models
@model Ignite.ExpertFinder.Dashboard.Models.Expert
@{
    ViewData["Title"] = "Registration Console";
}

<link href='https://fonts.googleapis.com/css?family=Open+Sans+Condensed:300' rel='stylesheet' type='text/css'>
<script src="js/jquery.webcam.js" type="text/javascript"></script>
<script type="text/javascript">
    $(function () {
        jQuery("#webcam").webcam({
            width: 320,
            height: 240,
            mode: "save",
            swffile: "js/jscam.swf",
            debug: function (type, status) {
                $('#camStatus').text(type + ": " + status);
            },
            onSave: function (data) {
                $.ajax({
                    type: "GET",
                    url: "/Home/GetCapturedImage",
                    data: '',
                    contentType: "application/json; charset=utf-8",
                    dataType: "json",
                    success: function (r) {
                        $("[id*=capturedImage]").attr("src", r);
                    },
                    failure: function (response) {
                        alert(response.d);
                    }
                });
            },
            onCapture: function () {
                webcam.save("/Home/SaveImage");
            }
        });
    });
    function Capture() {
        webcam.capture();
        return false;
    }
    function Validate() {
        var imageUri = $("[id*=capturedImage]").attr("src");
        $.ajax({
            type: "POST",
            url: "/Home/ValidateImage",
            data: { capturedImage: imageUri },
            success: function (r) {
                $('#camStatus').text(r);
                $("[id*=ProfilePicBlobUrl]").attr("value", imageUri);
            },
            failure: function (response) {
                alert(response.d);
            }
        });
        return false;
    }
</script>
<h2>Step 1. Upload Your Picture</h2>
<hr />
<div class="container-fluid">
    <div>
        <div class="row">
            <div class="col-md-6 col-sm-6 col-lg-6">
                <h3>Camera View</h3>
                <br />
                <div id="webcam">
                </div>
            </div>
            <div class="col-md-6 col-sm-6 col-lg-6">
                <h3>Captured Image</h3>
                <br />
                <img id="capturedImage" style="width: 320px; height: 240px" src="http://placehold.it/320x240" />
            </div>
        </div>
        <div class="row">
            <div class="col-md-6 col-sm-6 col-xs-6 col-lg-6">
                <button class="btn btn-default action" onclick="return Capture();">Capture</button>
            </div>
            <div class="col-md-6 col-sm-6 col-xs-6 col-lg-6">
                <button class="btn btn-default action" onclick="return Validate();">Validate</button>
            </div>
        </div>
        <h3>Notifications</h3>
        <span id="camStatus"></span>
    </div>
    <br />
    <br />
    <h2>Step 2. Register Your Details</h2>
    <hr />
    <form asp-controller="Home" asp-action="Submit" method="post" class="form-horizontal" role="form">
        <div class="form-group">
            <label asp-for="Name" class="col-md-2 control-label"></label>
            <div class="col-md-10">
                <input asp-for="Name" class="form-control" />
            </div>
        </div>
        <div class="form-group">
            <label asp-for="Organization" class="col-md-2 control-label"></label>
            <div class="col-md-10">
                <input asp-for="Organization" class="form-control" />
            </div>
        </div>
        <input asp-for="ProfilePicBlobUrl" type="hidden" id="ProfilePicBlobUrl" />
        <div class="form-group">
            <label asp-for="Skills" class="col-md-2 control-label"></label>
            <div class="col-md-10">
                @foreach (var skill in Enum.GetValues(typeof(Skills)))
                {
                    <input name="Skills" type="checkbox" value="@skill" />
                    <label asp-for="@skill" style="margin-right:10px">@skill</label>
                }
            </div>
        </div>
        <div class="col-xs-12">
            <input type="submit" value="Create Profile" class="btn btn-default submit pull-right" />
        </div>
    </form>
</div>